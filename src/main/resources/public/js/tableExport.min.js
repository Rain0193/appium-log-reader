!function(e){e.fn.tableExport=function(t){function n(){var e=a.find("thead tr th"),t=[];return e.each(function(e,n){i.length?i.forEach(function(o){o==e+1&&t.push(n.innerText)}):-1==r.indexOf((e+1).toString())&&t.push(n.innerText)}),t}function o(){var t=a.find("tbody tr"),n=[];return t.each(function(t,o){var a=[];i.length?(i.forEach(function(t){a.push(e(o).find("td:nth-child("+t+")").text())}),n.push(a)):(e(o).find("td").each(function(e,t){-1==r.indexOf((e+1).toString())&&a.push(t.innerText)}),n.push(a))}),n}t=e.extend({filename:"table",format:"csv",cols:"",excludeCols:"",head_delimiter:",",column_delimiter:",",quote:!0,onBefore:function(e){},onAfter:function(e){}},t);var a=e(this),i=t.cols?t.cols.split(","):[],r=t.excludeCols?t.excludeCols.split(","):[],c="",f={csv:"text/csv",txt:"text/plain",xls:"application/vnd.ms-excel",json:"application/json"};if(!("function"==typeof t.onBefore&&"function"==typeof t.onAfter&&t.format&&t.head_delimiter&&t.column_delimiter&&t.filename))return console.error("One of the parameters is incorrect."),!1;switch(t.onBefore(a),t.format){case"csv":var l=n(),u=o();if(!0===t.quote){var h=!0===t.quote?'"':null;l.forEach(function(e,t){l[t]=h+e+h}),u.forEach(function(e,t){e.forEach(function(t,n){e[n]=h+t+h})})}c+=l.join(t.head_delimiter)+"\n",u.forEach(function(e,n){c+=e.join(t.column_delimiter)+"\n"});break;case"txt":l=n(),u=o();c+=l.join(t.head_delimiter)+"\n",u.forEach(function(e,n){c+=e.join(t.column_delimiter)+"\n"});break;case"xls":l=n(),u=o();template="<table><thead>%thead%</thead><tbody>%tbody%</tbody></table>";var s="";l.forEach(function(e,t){s+="<th>"+e+"</th>"}),template=template.replace("%thead%",s),s="",u.forEach(function(e,t){s+="<tr>",e.forEach(function(e,t){s+="<td>"+e+"</td>"}),s+="</tr>"}),template=template.replace("%tbody%",s),c=template;break;case"sql":l=n();(u=o()).forEach(function(e,t){c+="INSERT INTO table ("+l.join(",")+") VALUES ('"+e.join("','")+"');\n"});break;case"json":l=n(),u=o();c=JSON.stringify({header:l,items:u})}(function(e,t,n){var o=document.createElement("a"),a=new Blob(["\ufeff",e],{type:f[n]});o.href=URL.createObjectURL(a);var i=new Date;["DD:"+i.getDate(),"MM:"+(i.getMonth()+1),"YY:"+i.getFullYear(),"hh:"+i.getHours(),"mm:"+i.getMinutes(),"ss:"+i.getSeconds()].forEach(function(e){var n=e.split(":")[0],o=e.split(":")[1],a=new RegExp("%"+n+"%","g");t=t.replace(a,o)}),o.download=t+"."+n,o.click(),navigator.userAgent.toLowerCase().match(/firefox/)||o.remove()})(c,t.filename,t.format),t.onAfter(a)}}(jQuery);